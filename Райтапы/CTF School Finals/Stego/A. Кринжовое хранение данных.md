Ну это вообще не вайбик. Я дружочка попросил засейвить данные в фоточке моей любимой из бумерского фильма, а он не хайпанул и засунул их непонятно как. Тот ещё босс художки... Поможете, зайки? `:_:`

*По заданию дан файл «matrix_in_us.png».*
___
Изображение данное в задании выглядит вот так:

![[matrix_in_us.png]]

Первое что мы решили сделать — это посмотреть метаданные с помощью утилиты `exiftool` и проверить тип данных с помощью команды `file`.

![[Райтапы/SchoolCTF/Stego/Вложеннные файлы/A/image2.png]]

![[Райтапы/SchoolCTF/Stego/Вложеннные файлы/A/image3.png]]

Так мы убедились что это действительно `png`, а также что изображение в `RGBA` (A – канал прозрачности).

После этого мы решили просмотреть саму картинку в `Stegsolve`. При изменении каналов `RGBA`﻿ можно обнаружить скрытую информацию, мы это проверили, но ничего не нашли — картинка довольно маленькая. Однако при каналах `red 0`, `blue 0`, `green 0` в верхней части изображения появлялись странные белые пиксели вдоль картинки. Затем мы перешли в меню `Data extract`﻿ и установили следующие настройки:

`- Bit order: LSBF (Least Significant Bit First)
`- Bit planes: red 0; green 0; blue 0;

После чего обнаружили флаг в начале файла через `Extract Preview`.

![[Райтапы/SchoolCTF/Stego/Вложеннные файлы/A/image4.png]]

Так как мы не увидели спрятанную информацию глазом, было сделано предположение, что были изменены младшие биты (0-3), которые не влияют на изображение, и с помощью `data extract` мы смогли обнаружить, что эти биты были закодированы как флаг.

**Как работает дешифрование LSB?**

Изменяются последние биты, извлекаются, группируются по 8 бит и преобразуются в символы по таблице ASCII.

Также можно просто использовать утилиту `zsteg` для работы с `png` файлами и она за вас обнаружит `lsb`, после чего отобразит спрятанный флаг.

![[Райтапы/SchoolCTF/Stego/Вложеннные файлы/A/image5.png]]
## `ctfschool{h1d1ng_d4t4_in_lsb_1s_0utd4t3d_cr1nge_but_st1ll_w0rks}`
